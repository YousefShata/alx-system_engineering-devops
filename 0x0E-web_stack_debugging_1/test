#!/bin/bash

# Path to the Nginx sites-enabled directory
sites_enabled_dir="/etc/nginx/sites-enabled"

# Check if there is a configuration without 'listen 80;' in sites-enabled
if grep -q -v "listen 80;" "$sites_enabled_dir"/*; then
    # If not, add 'listen 80;' to existing configurations
    echo "Adding 'listen 80;' to existing configurations..."

    # Append 'listen 80;' to each server block
    sed -i '/server {/ a \    listen 80;' "$sites_enabled_dir"/*

    # Restart Nginx to apply changes
    sudo systemctl restart nginx
    echo "'listen 80;' added to existing configurations, and Nginx restarted."
else
    echo "Port 80 configuration already exists."
fi
